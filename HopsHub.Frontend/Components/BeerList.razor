@using HopsHub.Shared.DTOs;
@using HopsHub.Frontend.Services.Interfaces;

@inject IBeerService beerService

@namespace HopsHub.Frontend.Components

@if (IsLoading)
{
    <p>Loading beers...</p>
}
else if (ErrorMessage != null)
{
    <p class="text-danger">@ErrorMessage</p>
}
else if (Beers.Any())
{
    <ul>
        @foreach (var beer in Beers)
        {
            <li>
                <BeerCard Name=@beer.Name
                          Alc=@beer.Alc
                          AverageScore=@beer.AverageScore
                          ImgUrl=""
                          Brewer="" />
            </li>
        }
    </ul>
}
else
{
    <p>No beers found.</p>
}

@code {
    private List<BeerDTO> Beers = new();
    private bool IsLoading = true;
    private string? ErrorMessage;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            Beers = await beerService.GetBeersAsync();
        }
        catch (Exception ex)
        {
            ErrorMessage = $"Error: {ex.Message}";
        }
        finally
        {
            IsLoading = false;
        }
    }
}
